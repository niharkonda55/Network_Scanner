{% extends 'base.html' %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Live Monitor</h1>
<div class="mb-4 flex items-center gap-4">
    <button id="capture-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Start Capture</button>
    <label for="ip-filter" class="font-semibold">Filter by IP:</label>
    <select id="ip-filter" class="px-2 py-1 border rounded">
        <option value="">All IPs</option>
    </select>
</div>
<div class="overflow-x-auto mb-8">
    <table class="min-w-full text-sm bg-white rounded shadow">
        <thead>
            <tr>
                <th class="px-2 py-1">Time</th>
                <th class="px-2 py-1">Source IP</th>
                <th class="px-2 py-1">Destination IP</th>
                <th class="px-2 py-1">Protocol</th>
                <th class="px-2 py-1">Src Port</th>
                <th class="px-2 py-1">Dst Port</th>
                <th class="px-2 py-1">URL</th>
                <th class="px-2 py-1">Size</th>
            </tr>
        </thead>
        <tbody id="packet-table-body">
            <!-- Live packets will be inserted here -->
        </tbody>
    </table>
</div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
    <div class="bg-white p-4 rounded shadow">
        <h2 class="text-lg font-semibold mb-2">Traffic Volume (Packets/sec)</h2>
        <canvas id="trafficChart" height="120"></canvas>
    </div>
    <div class="bg-white p-4 rounded shadow">
        <h2 class="text-lg font-semibold mb-2">Protocol Distribution</h2>
        <canvas id="protocolChart" height="120"></canvas>
    </div>
</div>
<div class="bg-white p-4 rounded shadow mb-8">
    <h2 class="text-lg font-semibold mb-2">Service/Port Analysis <span id="service-ip-label" class="text-gray-500 text-sm"></span></h2>
    <div class="overflow-x-auto">
        <table class="min-w-full text-sm">
            <thead>
                <tr>
                    <th class="px-2 py-1">Direction</th>
                    <th class="px-2 py-1">Port</th>
                    <th class="px-2 py-1">Protocol</th>
                    <th class="px-2 py-1">Service</th>
                    <th class="px-2 py-1">Packets</th>
                    <th class="px-2 py-1">Bytes</th>
                </tr>
            </thead>
            <tbody id="service-table-body">
                <!-- Service/port analysis will be inserted here -->
            </tbody>
        </table>
    </div>
</div>
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/live_monitor.js') }}"></script>
{% endblock %} 